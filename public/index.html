<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Memory Observatory</title>
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <div class="noise"></div>
    <main class="app-shell">
      <header class="topbar">
        <div>
          <p class="kicker">Local-first AI Memory</p>
          <h1>Memory Observatory</h1>
          <p class="tagline">Upload notes/files and manage daily tasks in one place.</p>
        </div>
        <div class="status-wrap">
          <span id="status-pill" class="status-pill">Checking backend...</span>
          <span id="memory-count" class="memory-count">0 memories</span>
        </div>
      </header>

      <nav class="tabs" aria-label="Main sections">
        <button id="tab-memory" class="tab-button active" type="button">Memory</button>
        <button id="tab-tasks" class="tab-button" type="button">Tasks</button>
      </nav>

      <section id="memory-page" class="page">
        <section class="insight-row">
          <article class="panel hero-metric">
            <p class="panel-label">Project Heatmap</p>
            <div id="project-chips" class="chip-grid"></div>
          </article>
          <article class="panel hero-metric">
            <p class="panel-label">Source Mix</p>
            <div id="source-bars" class="source-bars"></div>
          </article>
          <article class="panel hero-metric">
            <p class="panel-label">Fresh Memory</p>
            <div id="fresh-memory" class="fresh-memory">No data yet.</div>
          </article>
        </section>

        <section class="layout-grid">
          <article class="panel timeline-panel">
            <div class="panel-top">
              <h2>Memory Stream</h2>
              <button id="refresh-btn" class="button button-soft">Refresh</button>
            </div>
            <div class="filter-row">
              <input id="search-input" placeholder="Search all memory..." />
              <input id="project-filter-input" placeholder="Filter by project" />
              <button id="search-btn" class="button button-soft">Go</button>
            </div>
            <div id="timeline" class="timeline"></div>
          </article>

          <article class="panel inspector-panel">
            <h2>Inspector</h2>
            <p class="subtle">Click any memory to inspect full details and extracted content.</p>
            <div id="inspector" class="inspector-empty">Select a memory from the stream.</div>

            <div class="chat-block">
              <h3>Grounded Ask</h3>
              <form id="chat-form">
                <textarea id="question-input" rows="3" placeholder="What did I decide about MCP + OpenClaw integration?"></textarea>
                <button class="button" type="submit">Ask Memory</button>
              </form>
              <pre id="answer-output" class="answer-output">No question yet.</pre>
              <div id="citation-list" class="citation-list"></div>
              <button id="context-btn" class="button button-soft">Generate Context Brief</button>
            </div>
          </article>

          <article class="panel capture-panel">
            <h2>Capture New Memory</h2>
            <form id="capture-form">
              <label>
                Source type
                <select id="source-type" name="sourceType">
                  <option value="text">Text</option>
                  <option value="link">Link</option>
                  <option value="image">Image</option>
                  <option value="file">File</option>
                </select>
              </label>

              <label>
                Project
                <input id="project-input" name="project" placeholder="Hackathon Demo" />
              </label>

              <label id="source-url-wrap" class="hidden">
                Source URL
                <input id="source-url-input" name="sourceUrl" placeholder="https://..." />
              </label>

              <label>
                Content
                <textarea id="content-input" name="content" rows="6" placeholder="Write notes, decisions, TODOs..."></textarea>
              </label>

              <label id="image-wrap" class="hidden">
                Upload file
                <input id="image-input" type="file" accept="image/*,.pdf,.doc,.docx,.txt,.md,.rtf,.csv,.json,.xml,.html,.ppt,.pptx,.xls,.xlsx" />
                <img id="image-preview" alt="image preview" class="image-preview hidden" />
              </label>

              <button id="save-btn" class="button" type="submit">Save Memory</button>
            </form>
          </article>
        </section>
      </section>

      <section id="tasks-page" class="page hidden">
        <section class="tasks-layout">
          <article class="panel tasks-compose">
            <h2>Add Task</h2>
            <p class="subtle">Create simple action tasks like messaging people or running deep research.</p>
            <form id="task-form">
              <label>
                Task title
                <input id="task-title-input" placeholder="message ashna about weekend plans" />
              </label>
              <button class="button" type="submit">Add Task</button>
            </form>
          </article>

          <article class="panel tasks-list-panel">
            <div class="panel-top">
              <h2>Open Tasks</h2>
              <button id="tasks-refresh-btn" class="button button-soft" type="button">Refresh</button>
            </div>
            <div id="tasks-list" class="tasks-list"></div>
          </article>
        </section>
      </section>
    </main>

    <template id="timeline-item-template">
      <article class="memory-card">
        <div class="memory-head">
          <span class="memory-project"></span>
          <span class="memory-time"></span>
        </div>
        <p class="memory-summary"></p>
        <p class="memory-content"></p>
        <div class="memory-tags"></div>
      </article>
    </template>

    <script src="/app.js" type="module"></script>
  </body>
</html>
